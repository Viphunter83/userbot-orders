# Устранение проблем с auto-detect

## Проблема: Request timed out

Если команда `chat auto-detect` завершается с ошибкой "Request timed out", это нормально в следующих случаях:

### Причины таймаута:

1. **Много чатов/диалогов** - если у вас много групп и каналов, Telegram API может не успеть ответить
2. **Медленное интернет-соединение** - требуется время для загрузки всех диалогов
3. **Высокая нагрузка на серверы Telegram** - серверы могут быть перегружены

## Решения:

### Вариант 1: Повторить попытку

Команда автоматически делает до 5 попыток с экспоненциальной задержкой:

```bash
python3 -m src.main chat auto-detect
```

Если таймаут повторяется, попробуйте:
- Подождать несколько минут и повторить
- Проверить интернет-соединение
- Попробовать в другое время (меньше нагрузка на серверы)

### Вариант 2: Добавить чаты вручную (рекомендуется)

Если auto-detect не работает, вы можете добавить чаты вручную:

```bash
# Добавить чат
python3 -m src.main chat add <chat_id> --name "Название чата" --type supergroup

# Пример:
python3 -m src.main chat add -1001234567890 --name "IT Jobs" --type supergroup
```

### Как найти Chat ID:

1. **Через Telegram Desktop:**
   - Откройте чат/канал
   - Посмотрите в URL: `https://web.telegram.org/k/#-1001234567890`
   - Число после `#` - это Chat ID

2. **Через бота @userinfobot:**
   - Добавьте бота в группу/канал
   - Бот покажет Chat ID

3. **Через @RawDataBot:**
   - Отправьте боту любое сообщение из группы
   - Бот вернет полную информацию, включая Chat ID

### Вариант 3: Использовать существующие чаты

Если у вас уже есть чаты в конфигурации:

```bash
# Посмотреть список чатов
python3 -m src.main chat list

# Включить чат
python3 -m src.main chat enable <chat_id>
```

## Улучшения в коде:

✅ Увеличено количество попыток с 3 до 5  
✅ Улучшена обработка таймаутов с информативными сообщениями  
✅ Добавлены параметры retry для Pyrogram клиента  
✅ Добавлены рекомендации при отсутствии чатов

## Проверка работы:

После добавления чатов проверьте:

```bash
# Список чатов
python3 -m src.main chat list

# Запустить userbot
python3 -m src.main start
```

